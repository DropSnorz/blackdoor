<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, shrink-to-fit=no, initial-scale=1">
    <title>BlackDoor - Cours 2</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Code Mirror -->
    <script src="lib/codeMirror/lib/codemirror.js"></script>
    <link rel="stylesheet" href="lib/codeMirror/lib/codemirror.css">
    <link rel="stylesheet" href="lib/codeMirror/theme/night.css">
    <script src="lib/codeMirror/mode/clike/clike.js"></script>

    <!-- Custom CSS -->
    <link href="css/simple-sidebar.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div id="wrapper">
    <!-- Menu du cours -->
    <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
            <li class="sidebar-brand"><a href="index.html"> Blackdoor - Cours </a></li>
            <li><a href="index.html"> Accueil </a></li>
            <li><a href="cours1.html"> Cours 1 </a></li>
            <li><a id="liActive" href="cours2.html"> Shortcuts </a></li>
            <li><a href="cours3.html"> Overview </a></li>
            <li><a href="cours4.html"> Events </a></li>
            <li><a href="cours5.html"> About </a></li>
            <li><a href="cours6.html"> Services </a></li>
            <li><a href="cours7.html"> Contact </a></li>
            <li><a href="cours8.html"> Contact </a></li>
            <li><a href="cours9.html"> Contact </a></li>
        </ul>
    </div>
    <!-- Fin menu du cours -->

    <!-- Icone du menu -->
    <div id="menuWrapper">
        <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">
            <span class="glyphicon glyphicon-menu-hamburger" id="spanMenu"></span>
        </a>
    </div>

    <!-- Page content -->
    <div id="page-content-wrapper">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1 id="titreCours">La classe TelephonyManager</h1>
                    <h2>Préambule</h2>
                    <p>
                        Lors du premier cours, nous avons vu comment utiliser le vibreur présent sur les téléphones mobiles, pour pouvoir augmenter les possibilitées d'interaction entre notre application et l'utilisateur. C'est déjà bien, me direz-vous. Mais imaginez tout ce que nous pourrions faire si nous avions accès à des informations provenant du mobile de l'utilisateur. Imaginez si nous pouvions accéder à ses photos, ses contacts ou encore à sa position GPS. Plus besoin de l'imaginer : C'est possible ! C'est ce que nous allons voir dans ce chapitre, par l'intermédiaire de la classe <code>TelephonyManager</code>
                    </p>

                    <h2> Fonctionnement de la classe </h2>

                    <p>
                        La classe TelephonyManager permet d'accéder à des informations concernant de téléphone de l'utilisateur, ou sur le téléphone lui même. Elle nous met à disposition un ensemble de constantes et de méthodes nous permettant de manipuler ces données. Enfin, l'application va pouvoir "écouter" et recevoir des notifications en provenance du mobile, ce qui va nous permettre de réagir à des évènements extérieurs.
                    </p>

                    <div class="alert alert-warning">
                        <strong> Attention - </strong> Avant de pouvoir manipuler ces données, il faut que l'utilisateur vous donne l'autorisation. C'est pour cela qu'une fenêtre s'affiche lorsque l'on télécharge une application mobile via le Google Play, ou l'application nous demande une autorisation pour accéder à certaines données
                    </div>

                    <p>
                        Pour utiliser cette classe, nous ne pouvons pas créer une instance de classe directement. Il faut passer une référence à une instance, de la forme <code>Context.getSystemService(Context.TELEPHONY_SERVICE)</code>. Cette syntaxe vous semble familière ? C'est normal ! C'est de cette façon que l'on a instancié la classe Vibrator au chapitre précédent. Sauf que cette fois, on passe une référence. Facile, n'est-il pas ?
                    </p>

                    <div class="alert alert-warning">
                        <strong> Attention - </strong> Il est nécessaire d'inclure <code>android.telephony.TelephonyManager</code> en tant que dépendance pour utiliser la classe <code>TelephonyManager</code>
                    </div>

                    <p> Comme au chapitre précédent, voici quelques fonctions utiles provenant de cette classe </p>

                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>Type</th>
                            <th>Fonction</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>TelephonyManager</td>
                            <td> <code>createForSubscriptionId(int subId)</code> <br>

                                Crée un nouvel objet de type TelephonyManager, épinglé à l'ID donné en paramètre
                            </td>
                        </tr>
                        <tr>
                            <td>int</td>
                            <td> <code>getCallState()</code> <br>

                                Retourne une constante représentant l'état actuel de tous les appels téléphoniques de l'appareil
                            </td>
                        </tr>
                        <tr>
                            <td>int</td>
                            <td> <code>getDataNetworkType()</code> <br>

                                Retourne une constante représentant le type de connection réseau du mobile (WIFI, Données mobiles, etc)
                            </td>
                        </tr>
                        <tr>
                            <td>String</td>
                            <td> <code>getDeviceSoftwareVersion()</code> <br>

                                Retourne la version du software du téléphone de l'utilisateur
                            </td>
                        </tr>
                        <tr>
                            <td>String</td>
                            <td> <code>getLine1Number()</code> <br>

                                Retourne le numéro de téléphone sous forme de chaine de caractères
                            </td>
                        </tr>
                        <tr>
                            <td>String</td>
                            <td> <code>getNetworkOperatorName()</code> <br>

                                Retourne le nom de l'opérateur du mobile courant (Orange, SFR, etc)
                            </td>
                        </tr>
                        <tr>
                            <td>int</td>
                            <td> <code>getSimState()</code> <br>

                                Retourne une constante concernant l'état de la carte SIM du mobile
                            </td>
                        </tr>
                        <tr>
                            <td>String</td>
                            <td> <code>getVoiceMailNumber()</code> <br>

                                Retourne le numéro de la boîte vocale du mobile
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <div class="alert alert-warning">
                        <strong> Attention - </strong> Beaucoup de fonctions sont disponibles, dont certaines dépréciées. Pour plus d'informations, consultez <a href="https://developer.android.com/reference/android/telephony/TelephonyManager.html"> l'API Android</a>
                    </div>

                    <div class="alert alert-info">
                        <strong> Info - </strong> De nombreuses constantes existent pour cette classe. Vous les retrouverez en détail sur <a href="https://developer.android.com/reference/android/telephony/TelephonyManager.html">l'API Android</a> !
                    </div>

                    <p>
                        Il n'est pas possible de dégager des fonctions plus utiles que d'autres. La classe <code>TelephonyManager</code> offre de très nombreuses fonctions, toutes plus spécifiques les unes que les autres. Vous aurez très souvent recours à cette classe, mais pas forcément pour les même raisons. Un jour vous aurez besoin d'informations sur l'opérateur de l'utilisateur, un autre jour vous aurez besoin de connaitre la version du software du mobile. Tout est situationnel, mais extrêmement pratique !
                    </p>

                    <h2> A vous de jouer !</h2>

                    <p>
                        C'est à vous de travailler. On va mettre en pratique tous les éléments vus dans ce chapitre. Votre mission, si vous l'acceptez, consiste à récupérer le nom de l'opérateur (que l'on note [opérateur] ci-dessous), le numéro de téléphone (que l'on note [numero] ci-dessous) ainsi que le numéro de la boite vocale (que l'on note [boiteVocale] ci-dessous) de l'utilisateur. Vous devez ainsi obtenir la phrase suivante <code>Le numéro de téléphone [numéro] est chez l'opérateur [opérateur] et à pour numéro de boîte vocale : [boiteVocale]</code>. N'oubliez pas les fonctions que vous avez vu dans ce chapitre, et n'hésitez pas à consulter l'<a href="https://developer.android.com/reference/android/telephony/TelephonyManager.html"> API Android</a>. Bonne chance les amis, vous avez deux heures !
                    </p>

                    <h2> Solution de l'exercice </h2>

                    <p> Stoooop, on lève les stylos, c'est l'heure de la correction !</p>

                    <div class="zoneCodeWrapper">
                           <textarea class="zoneCode">
import java.lang.Object; //Contient android.telephony.TelephonyManager

TelephonyManager mobile = (TelephonyManager) Context.getSystemService(Context.TELEPHONY_SERVICE); // mobile correspond à l'appareil de l'utilisateur, sur lequel on va appeler les méthodes
String operateur = mobile.getNetworkOperatorName() ; // On stock le nom de l'opérateur
String numero = mobile.getLine1Number(); // On stock le numéro de téléphone
String boiteVocale = mobile.getVoiceMailNumber(); // On stock le numéro de la boîte vocale
System.out.println("Le numéro de téléphone " + numero + " est chez l'opérateur " + operateur + " et à pour numéro de boîte vocale : " + boiteVocale); // On affiche le message
                           </textarea>
                        <div class="zoneCodeLegende">Solution possible pour l'exercice sur TelephonyManager</div>
                    </div>

                    <p>
                        Voici la solution que nous vous proposons. Rien de bien difficile, mais détaillons quand même brievement le code ci-dessus. On commence par instancier indirectement un objet de type TelephonyManager, que l'on nomme "mobile". Ensuite, on va créer trois variables (une pour chaque élément), et nous appliquons des méthodes sur "mobile" pour en extirper les informations que nous souhaitons. Pas besoin de caster nos valeurs, puisque ces méthodes renvoient des chaînes de caractères. Enfin, il ne nous reste plus qu'à concaténer nos variables dans une phrase, et à l'afficher avec la fonction <code>System.out.println()</code>
                    </p>

                    <p>
                        Ces notions sont acquises ? Partons ensemble à l'aventure vers le prochain chapitre !
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="js/jquery.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/perso.js"></script>
</body>
</html>
